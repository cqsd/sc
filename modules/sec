#!/bin/bash

_sec_short_help() {
    echo "Security tool shortcuts"
}

_sec() {
    echo "usage: $(basename $0) ${FUNCNAME[0]} subcommand"
    echo
    echo "available subcommands are:"
    echo "  trufflehog - run trufflehog (you can pass args)"
}

_sec_trufflehog() {
    if ! [ -f ~/.venvs/utils/bin/trufflehog ]; then
        __warn "Couldn't find ~/.venvs/utils/bin/trufflehog"
        __warn "Either set that up, or set SC_TRUFFLEHOG_PATH"
        exit 1
    fi
    TRUFFLEHOG=${SC_TRUFFLEHOG_PATH:-~/.venvs/utils/bin/trufflehog}
    ${TRUFFLEHOG} \
        --regex \
        --entropy false \
        --rules $(dirname ${BASH_SOURCE[0]})/../config/trufflehog-rules.json \
        $*
}
